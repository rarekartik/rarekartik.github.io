<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BillForge Pro | Kartik Chouhan</title>
    
    <link href="https://api.fontshare.com/v2/css?f[]=satoshi@900,700,500,400&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg: #0a0a0a; 
            --surface: #171717; 
            --surface-hover: #262626; 
            --border: #333333;
            --text: #ffffff; 
            --text-dim: #a1a1aa; 
            --accent: #3b82f6; 
            --radius: 12px;
            --paper: #ffffff;
            --paper-text: #0f172a;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            background-color: var(--bg); color: var(--text); 
            font-family: 'Satoshi', sans-serif; 
            height: 100vh; overflow: hidden; 
            display: flex; flex-direction: column;
        }

        /* === 1. TOP HEADER === */
        .header {
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            padding: 15px 25px;
            display: flex; justify-content: space-between; align-items: center;
            flex-shrink: 0; z-index: 60;
        }
        .brand-group { display: flex; align-items: center; gap: 15px; }
        .brand-logo { font-size: 1.4rem; font-weight: 900; color: white; display: flex; align-items: center; gap: 10px; }
        .brand-logo i { color: var(--accent); }
        .brand-desc { font-size: 0.8rem; color: var(--text-dim); border-left: 1px solid var(--border); padding-left: 15px; display: flex; flex-direction: column; }
        .credit { color: var(--accent); font-weight: 700; font-size: 0.75rem; }
        
        .nav-back { color: var(--text-dim); text-decoration: none; font-weight: 600; font-size: 0.9rem; transition: 0.3s; display: flex; align-items: center; gap: 8px; }
        .nav-back:hover { color: var(--accent); }

        /* === 2. RIBBON TOOLBAR (DESKTOP) === */
        .toolbar {
            background: var(--bg);
            border-bottom: 1px solid var(--border);
            display: flex; flex-direction: row;
            padding: 10px 20px; gap: 20px;
            overflow-x: auto; /* Scroll horizontal */
            flex-shrink: 0; align-items: stretch;
            height: auto;
            position: relative;
            z-index: 50;
        }

        .control-group {
            display: flex; flex-direction: column; gap: 8px;
            min-width: 180px; max-width: 240px;
            border-right: 1px solid var(--border);
            padding-right: 20px;
        }
        .control-group:last-child { border-right: none; }

        .group-label {
            font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.1em;
            color: var(--text-dim); font-weight: 700; display: flex; align-items: center; gap: 5px;
            margin-bottom: 5px;
        }
        .group-label i { color: var(--accent); }

        /* Inputs */
        input, textarea {
            width: 100%; background: var(--surface); border: 1px solid var(--border);
            color: var(--text); padding: 8px 10px; border-radius: 6px;
            font-family: 'Satoshi', sans-serif; outline: none;
            transition: 0.3s; font-size: 0.85rem;
        }
        input:focus, textarea:focus { border-color: var(--accent); background: #000; }
        textarea { resize: none; height: 36px; }
        .row-2 { display: flex; gap: 8px; }

        .btn-primary {
            background: var(--text); color: var(--bg); border: none; padding: 10px; width: 100%; border-radius: 8px;
            font-weight: 800; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px;
            font-size: 0.9rem; transition: 0.3s; margin-top: auto;
        }
        .btn-primary:hover { background: var(--accent); color: white; }
        
        .btn-outline {
            background: transparent; border: 1px solid var(--border); color: var(--text-dim);
            padding: 6px; width: 100%; border-radius: 6px; font-weight: 600; cursor: pointer;
            display: flex; align-items: center; justify-content: center; gap: 5px; font-size: 0.8rem;
        }
        .btn-outline:hover { border-color: var(--accent); color: var(--accent); }

        /* === 3. CANVAS (Preview) === */
        .canvas {
            flex-grow: 1; background: #0c0c0c; 
            background-image: radial-gradient(#222 1px, transparent 1px);
            background-size: 20px 20px;
            padding: 40px; overflow: auto;
            display: flex; justify-content: center; align-items: flex-start;
        }

        /* === 4. INVOICE PAPER (Desktop Zoomed) === */
        .invoice-paper {
            width: 210mm; min-height: 297mm;
            background: var(--paper); color: var(--paper-text);
            padding: 15mm;
            box-shadow: 0 0 60px rgba(0,0,0,0.6);
            font-family: 'Inter', sans-serif;
            position: relative;
            flex-shrink: 0;
            /* Zoom for Desktop so it fits nicely */
            transform: scale(0.9); transform-origin: top center;
        }

        /* Invoice Styling */
        .inv-top { display: flex; justify-content: space-between; margin-bottom: 40px; }
        .inv-logo-box { width: 80px; height: 80px; background: #f1f5f9; border-radius: 8px; display: flex; align-items: center; justify-content: center; overflow: hidden; cursor: pointer; }
        .inv-logo-box img { width: 100%; height: 100%; object-fit: contain; }
        .inv-title-large { font-size: 2.5rem; font-weight: 800; color: #334155; text-transform: uppercase; }
        .inv-grid { display: flex; justify-content: space-between; gap: 20px; margin-bottom: 30px; font-size: 0.9rem; }
        .inv-box h4 { margin: 0 0 5px 0; color: #64748b; text-transform: uppercase; font-size: 0.75rem; }
        .inv-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .inv-table th { background: #f8fafc; color: #64748b; text-align: left; padding: 10px; font-size: 0.75rem; text-transform: uppercase; border-bottom: 2px solid #e2e8f0; }
        .inv-table td { padding: 10px; border-bottom: 1px solid #e2e8f0; font-size: 0.9rem; vertical-align: middle; }
        .inv-table td.num { text-align: right; }
        .del-row-btn { color: #ef4444; cursor: pointer; }
        .inv-footer { display: flex; justify-content: flex-end; }
        .inv-totals { width: 250px; text-align: right; }
        .inv-row { display: flex; justify-content: space-between; padding: 5px 0; font-size: 0.9rem; }
        .inv-total-final { font-weight: 800; font-size: 1.1rem; border-top: 2px solid #334155; margin-top: 5px; padding-top: 5px; color: var(--accent); }
        .inv-notes { margin-top: 40px; border-top: 1px solid #e2e8f0; padding-top: 20px; font-size: 0.8rem; color: #64748b; }

        /* === MOBILE FIXES (Clean Side Drawer) === */
        .mobile-toggle { display: none; } 
        .backdrop { display: none; }

        @media (max-width: 900px) {
            .header { padding: 15px; position: sticky; top: 0; z-index: 100; border-bottom: 1px solid var(--border); }
            .brand-desc { display: none; } /* Simpler Header */
            
            /* 1. Mobile Edit Button */
            .mobile-toggle { 
                display: flex; align-items: center; justify-content: center;
                width: 40px; height: 40px; border-radius: 8px;
                background: var(--surface-hover); color: white; border: 1px solid var(--border);
                margin-right: 15px; font-size: 1.2rem; cursor: pointer;
            }

            /* 2. The Drawer (Slide from Left) */
            .toolbar { 
                position: fixed; top: 0; left: 0; height: 100vh; width: 85vw; /* 85% width */
                background: #111; flex-direction: column; /* Stack Vertically */
                z-index: 2000; padding: 25px; gap: 30px;
                overflow-y: auto; overflow-x: hidden;
                border-right: 1px solid var(--border); 
                box-shadow: 10px 0 50px rgba(0,0,0,0.5);
                transform: translateX(-100%); transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }
            .toolbar.active { transform: translateX(0); }

            /* 3. Inputs inside Drawer */
            .control-group { 
                width: 100%; max-width: none; min-width: 0; 
                border-right: none; border-bottom: 1px solid var(--border);
                padding-right: 0; padding-bottom: 20px;
            }
            .control-group:last-child { border-bottom: none; }
            
            /* 4. Backdrop Overlay */
            .backdrop {
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.8); backdrop-filter: blur(3px);
                z-index: 1500; display: none;
            }
            .backdrop.active { display: block; }

            /* 5. Close Button */
            .drawer-close {
                display: flex; justify-content: flex-end; width: 100%;
                color: var(--text-dim); font-size: 1.5rem; cursor: pointer;
                margin-bottom: 10px;
            }

            /* 6. Mobile Canvas */
            .canvas { padding: 15px; display: block; overflow-x: auto; background: #000; }
            .invoice-paper { 
                transform: scale(0.44); transform-origin: top left; 
                margin: 0; margin-bottom: -150mm; width: 210mm;
            }
        }

        /* === PRINT FIX (Strict A4) === */
        @media print {
            body * { visibility: hidden; } /* Hide UI */
            .invoice-paper, .invoice-paper * { visibility: visible; } /* Show Paper */
            
            .invoice-paper {
                position: absolute; left: 0; top: 0;
                width: 210mm; min-height: 297mm;
                margin: 0; padding: 15mm;
                transform: none !important; /* No zoom */
                box-shadow: none; background: white;
            }
            @page { size: A4; margin: 0; }
        }
    </style>
</head>
<body>

    <div class="backdrop" id="backdrop" onclick="toggleDrawer()"></div>

    <header class="header">
        <div style="display:flex; align-items:center;">
            <div class="mobile-toggle" onclick="toggleDrawer()"><i class="fas fa-bars"></i></div>
            
            <div class="brand-group">
                <div class="brand-logo"><i class="fas fa-file-invoice"></i> BillForge Pro</div>
                <div class="brand-desc">
                    <span>Invoice Generator</span>
                    <span class="credit">Developed by Kartik Chouhan</span>
                </div>
            </div>
        </div>
        <a href="index.html" class="nav-back"><i class="fas fa-arrow-left"></i> Home</a>
    </header>

    <div class="toolbar" id="drawer">
        
        <div class="drawer-close" onclick="toggleDrawer()" style="display:none;"><i class="fas fa-times"></i></div>

        <div class="control-group">
            <div class="group-label"><i class="fas fa-building"></i> From (You)</div>
            <input type="text" id="inpCompName" placeholder="Company Name" oninput="syncInputs()">
            <textarea id="inpCompAddr" placeholder="Address & GSTIN" oninput="syncInputs()"></textarea>
            <button class="btn-outline" onclick="document.getElementById('logoInput').click()"><i class="fas fa-upload"></i> Logo</button>
            <input type="file" id="logoInput" hidden accept="image/*" onchange="loadLogo(this)">
        </div>

        <div class="control-group">
            <div class="group-label"><i class="fas fa-user"></i> Bill To</div>
            <input type="text" id="inpClientName" placeholder="Client Name" oninput="syncInputs()">
            <textarea id="inpClientAddr" placeholder="Client Address" oninput="syncInputs()"></textarea>
            <div class="row-2">
                <input type="text" id="inpInvNum" placeholder="Inv #" oninput="syncInputs()">
                <input type="date" id="inpDate" onchange="syncInputs()">
            </div>
        </div>

        <div class="control-group">
            <div class="group-label"><i class="fas fa-calculator"></i> Details</div>
            <div class="row-2">
                <input type="text" id="currency" value="â‚¹" placeholder="Curr" oninput="calculate()">
                <input type="number" id="taxRate" value="18" placeholder="Tax %" oninput="calculate()">
            </div>
            <input type="number" id="discRate" value="0" placeholder="Discount %" oninput="calculate()">
            <button class="btn-outline" onclick="addItem()"><i class="fas fa-plus"></i> Add Item Row</button>
        </div>

        <div class="control-group">
            <div class="group-label"><i class="fas fa-university"></i> Payment</div>
            <input type="text" id="inpBankName" placeholder="Bank Name" oninput="syncInputs()">
            <div class="row-2">
                <input type="text" id="inpAccNo" placeholder="Acc No" oninput="syncInputs()">
                <input type="text" id="inpIFSC" placeholder="IFSC" oninput="syncInputs()">
            </div>
            <input type="text" id="inpUPI" placeholder="UPI ID" oninput="syncInputs()">
        </div>

        <div class="control-group" style="border:none; min-width: 150px;">
            <div class="group-label"><i class="fas fa-save"></i> Finish</div>
            <button class="btn-primary" onclick="window.print()">
                <i class="fas fa-file-pdf"></i> Save PDF
            </button>
        </div>
    </div>

    <div class="canvas">
        <div class="invoice-paper" id="invoice">
            
            <div class="inv-top">
                <div style="display:flex; gap:15px;">
                    <div class="inv-logo-box" id="logoBox" onclick="document.getElementById('logoInput').click()">
                        <span style="font-size:0.7rem; color:#ccc; text-align:center;">Click to<br>Upload</span>
                        <img id="logoImg" style="display:none;">
                    </div>
                    <div>
                        <h3 style="margin:0; color:#0f172a;" id="outCompName">Your Company</h3>
                        <p style="margin:5px 0 0 0; font-size:0.85rem; color:#64748b; white-space:pre-line;" id="outCompAddr">Address, City</p>
                    </div>
                </div>
                <div>
                    <div class="inv-title-large" style="color:var(--accent)">INVOICE</div>
                    <div style="text-align:right; font-size:0.9rem; color:#64748b; margin-top:5px;">
                        # <span id="outInvNum">INV-001</span>
                    </div>
                </div>
            </div>

            <div class="inv-grid">
                <div class="inv-box">
                    <h4>Bill To:</h4>
                    <strong id="outClientName" style="font-size:1rem; display:block; margin-bottom:3px;">Client Name</strong>
                    <p id="outClientAddr">Client Address</p>
                </div>
                <div class="inv-box" style="text-align:right;">
                    <h4>Date:</h4>
                    <p id="outDate">2025-01-01</p>
                </div>
            </div>

            <table class="inv-table">
                <thead>
                    <tr>
                        <th style="width:50%;">Description</th>
                        <th style="width:15%; text-align:right;">Qty</th>
                        <th style="width:15%; text-align:right;">Rate</th>
                        <th style="width:20%; text-align:right;">Amount</th>
                        <th style="width:5%;"></th>
                    </tr>
                </thead>
                <tbody id="itemTable"></tbody>
            </table>

            <div class="inv-footer">
                <div class="inv-totals">
                    <div class="inv-row"><span>Subtotal:</span> <span id="outSub">0.00</span></div>
                    <div class="inv-row" id="rowDisc" style="display:none; color:#ef4444;"><span>Discount:</span> <span id="outDisc">0.00</span></div>
                    <div class="inv-row"><span>Tax (<span id="outTaxRate">18</span>%):</span> <span id="outTax">0.00</span></div>
                    <div class="inv-total-final"><span>Total:</span> <span id="outTotal">0.00</span></div>
                </div>
            </div>

            <div class="inv-notes">
                <strong>Bank Details:</strong><br>
                Bank: <span id="outBankName">HDFC Bank</span> | A/C: <span id="outAccNo">123456789</span> | IFSC: <span id="outIFSC">HDFC000123</span>
                <br><span id="outUPIContainer" style="display:none;">UPI ID: <span id="outUPI"></span></span>
                <br><br>
                <strong>Terms:</strong> Payment due within 15 days.
            </div>

        </div>
    </div>

    <script>
        // Toggle Logic
        function toggleDrawer() {
            document.getElementById('drawer').classList.toggle('active');
            document.getElementById('backdrop').classList.toggle('active');
        }

        // --- Data Logic (Same as before) ---
        function syncInputs() {
            const setVal = (inId, outId, def) => {
                const val = document.getElementById(inId).value;
                const el = document.getElementById(outId);
                if(el) el.innerText = val || def;
            };

            setVal('inpCompName', 'outCompName', 'Your Company');
            setVal('inpCompAddr', 'outCompAddr', 'Address Line 1, City');
            setVal('inpClientName', 'outClientName', 'Client Name');
            setVal('inpClientAddr', 'outClientAddr', 'Client Address');
            setVal('inpInvNum', 'outInvNum', 'INV-001');
            setVal('inpDate', 'outDate', new Date().toLocaleDateString());
            setVal('inpBankName', 'outBankName', 'HDFC Bank');
            setVal('inpAccNo', 'outAccNo', '123456789');
            setVal('inpIFSC', 'outIFSC', 'HDFC000123');
            
            const upi = document.getElementById('inpUPI').value;
            const upiBox = document.getElementById('outUPIContainer');
            if(upi) {
                upiBox.style.display = 'inline';
                document.getElementById('outUPI').innerText = upi;
            } else {
                upiBox.style.display = 'none';
            }
        }

        function addItem() {
            const tbody = document.getElementById('itemTable');
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td><input type="text" value="Product / Service" style="background:transparent; border:none; padding:0; margin:0; color:#334155; font-size:0.9rem;" oninput="calculate()"></td>
                <td class="num"><input type="number" value="1" style="background:transparent; border:none; padding:0; margin:0; text-align:right; color:#334155;" oninput="calculate()" class="qty"></td>
                <td class="num"><input type="number" value="0" style="background:transparent; border:none; padding:0; margin:0; text-align:right; color:#334155;" oninput="calculate()" class="rate"></td>
                <td class="num amount">0.00</td>
                <td style="text-align:center;"><i class="fas fa-trash del-row-btn" onclick="this.closest('tr').remove(); calculate();"></i></td>
            `;
            tbody.appendChild(tr);
            calculate();
        }

        function calculate() {
            const symbol = document.getElementById('currency').value;
            const taxP = parseFloat(document.getElementById('taxRate').value) || 0;
            const discP = parseFloat(document.getElementById('discRate').value) || 0;
            document.getElementById('outTaxRate').innerText = taxP;

            let sub = 0;
            document.querySelectorAll('#itemTable tr').forEach(row => {
                const qty = parseFloat(row.querySelector('.qty').value) || 0;
                const rate = parseFloat(row.querySelector('.rate').value) || 0;
                const amt = qty * rate;
                row.querySelector('.amount').innerText = symbol + amt.toFixed(2);
                sub += amt;
            });

            const discAmt = (sub * discP) / 100;
            const taxable = sub - discAmt;
            const taxAmt = (taxable * taxP) / 100;
            const total = taxable + taxAmt;

            document.getElementById('outSub').innerText = symbol + sub.toFixed(2);
            if(discP > 0) {
                document.getElementById('rowDisc').style.display = 'flex';
                document.getElementById('outDisc').innerText = "-" + symbol + discAmt.toFixed(2);
            } else {
                document.getElementById('rowDisc').style.display = 'none';
            }
            document.getElementById('outTax').innerText = symbol + taxAmt.toFixed(2);
            document.getElementById('outTotal').innerText = symbol + total.toFixed(2);
        }

        function loadLogo(input) {
            if(input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = e => {
                    const img = document.getElementById('logoImg');
                    img.src = e.target.result;
                    img.style.display = 'block';
                    document.querySelector('#logoBox span').style.display = 'none';
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        document.getElementById('inpDate').valueAsDate = new Date();
        addItem();
        syncInputs();
    </script>

</body>
</html>